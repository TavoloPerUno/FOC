<?xml version="1.0" encoding="UTF-8"?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:fo="http://www.w3.org/1999/XSL/Format">	<xsl:output encoding="UTF-8" method="xml"/>	<!-- #################### Inc files ####################### -->	<xsl:include href="formats.xsl"/>	<!-- #################### Global parameters ####################### -->	<xsl:param name="language" select="'DE'"/>	<xsl:param name="translation-list-file" select="'../XML/Translation-List.xml'"/>	<!-- #################### Global variables ####################### -->	<xsl:variable name="translation-list">		<xsl:copy-of select="document($translation-list-file)/Translation-List"/>	</xsl:variable>	<!-- #################### Page layout definitions ####################### -->	<!-- Root template -->	<xsl:template match="/">		<fo:root>			<fo:layout-master-set>				<!-- TOC Page -->				<fo:simple-page-master master-name="TOC-page" page-height="29.7cm" page-width="21cm" margin-top="1cm" margin-bottom="2cm" margin-left="1.5cm" margin-right="0.5cm">					<!-- Printable region -->					<fo:region-body region-name="xsl-region-body" margin-bottom="1cm"/>					<!-- Printable top region -->					<fo:region-before extent="1cm" region-name="TOC-region-before"/>					<!-- Printable bottom region -->					<fo:region-after extent="1cm" region-name="TOC-region-after"/>				</fo:simple-page-master>				<!-- First page -->				<fo:simple-page-master master-name="First" page-height="29.7cm" page-width="21cm" margin-top="7cm" margin-bottom="2cm" margin-left="0.5cm" margin-right="1.5cm">					<!-- Printable region -->					<fo:region-body region-name="xsl-region-body" background-color="linen" margin-bottom="1cm"/>					<!--  Printable top region -->					<fo:region-before extent="1cm" region-name="first-region-before"/>					<!--  Printable bottom region -->					<fo:region-after extent="1cm" region-name="first-region-after"/>				</fo:simple-page-master>				<!-- Odd page -->				<fo:simple-page-master master-name="Odd" page-height="29.7cm" page-width="21cm" margin-top="1cm" margin-bottom="2cm" margin-left="1.5cm" margin-right="0.5cm">					<!-- Printable top region -->					<fo:region-body region-name="xsl-region-body" background-color="linen" margin-top="1cm" margin-bottom="1cm"/>					<!--  Printable top region -->					<fo:region-before extent="1cm" region-name="odd-region-before"/>					<!--  Printable bottom region -->					<fo:region-after extent="1cm" region-name="odd-region-after"/>				</fo:simple-page-master>				<!-- Even page -->				<fo:simple-page-master master-name="Even" page-height="29.7cm" page-width="21cm" margin-top="1cm" margin-bottom="2cm" margin-left="0.5cm" margin-right="1.5cm">					<!-- Printable top region -->					<fo:region-body region-name="xsl-region-body" background-color="linen" margin-top="1cm" margin-bottom="1cm"/>					<!-- Printable top region -->					<fo:region-before extent="1cm" region-name="even-region-before"/>					<!-- Printable bottom region  -->					<fo:region-after extent="1cm" region-name="even-region-after"/>				</fo:simple-page-master>				<!-- Chapter  -->				<fo:page-sequence-master master-name="Chapter">					<!-- Seitenalternativen -->					<fo:repeatable-page-master-alternatives>						<fo:conditional-page-master-reference master-reference="TOC-page" page-position="first"/>						<fo:conditional-page-master-reference master-reference="Odd" odd-or-even="odd"/>						<fo:conditional-page-master-reference master-reference="Even" odd-or-even="even"/>					</fo:repeatable-page-master-alternatives>				</fo:page-sequence-master>				<!-- Inhaltsverzeichnis -->				<fo:page-sequence-master master-name="TOC">					<!-- Seitenalternativen -->					<fo:repeatable-page-master-alternatives>						<fo:conditional-page-master-reference master-reference="TOC-page" page-position="first"/>						<fo:conditional-page-master-reference master-reference="Odd" odd-or-even="odd"/>						<fo:conditional-page-master-reference master-reference="Even" odd-or-even="even"/>					</fo:repeatable-page-master-alternatives>				</fo:page-sequence-master>			</fo:layout-master-set>			<!-- #################### Page sequence: Intro ####################### -->			<fo:page-sequence master-reference="TOC" force-page-count="even" initial-page-number="1">				<!-- Seitenzahlen -->				<fo:static-content flow-name="first-region-after">					<fo:block text-align="right">Seite <fo:page-number/>					</fo:block>				</fo:static-content>				<fo:static-content flow-name="even-region-after">					<fo:block text-align="left">Page <fo:page-number/>					</fo:block>				</fo:static-content>				<fo:static-content flow-name="odd-region-after">					<fo:block text-align="right">Page <fo:page-number/>					</fo:block>				</fo:static-content>				<!-- Titel -->				<fo:static-content flow-name="even-region-before">					<fo:block text-align="center">Comelio GmbH - www.comelio-seminare.com</fo:block>				</fo:static-content>				<fo:static-content flow-name="odd-region-before">					<fo:block text-align="center">						<fo:block text-align="center">							<xsl:value-of select="$translation-list//Translation[ID = '1' and Language = $language]/Value"/>						</fo:block>					</fo:block>				</fo:static-content>				<!-- Regular content -->				<fo:flow flow-name="xsl-region-body">					<fo:block text-align="center">						<fo:external-graphic src="../Images/Comelio-Logo.png"/>					</fo:block>					<fo:block text-align="center" xsl:use-attribute-sets="title1">						<xsl:value-of select="$translation-list//Translation[ID = '1' and Language = $language]/Value"/>					</fo:block>					<!-- Table of Contents -->					<fo:list-block provisional-distance-between-starts="7mm" provisional-label-separation="2mm" start-indent="2mm" >						<xsl:for-each select="//COURSE">							<xsl:sort select="TITLE"/>							<xsl:sort select="SUBTITLE"/>							<fo:list-item>								<fo:list-item-label end-indent="label-end()">									<fo:block font-family="Courier" font-size="15pt" line-height="14pt" padding-before="2pt">&#x2022;</fo:block>								</fo:list-item-label>								<fo:list-item-body start-indent="body-start()">									<fo:block text-align-last="justify">										<xsl:value-of select="concat(TITLE, ' - ' , SUBTITLE)"/>										<fo:leader leader-pattern="dots"/>										<fo:page-number-citation ref-id="{concat(TITLE, ' - ' , SUBTITLE)}"/>									</fo:block>								</fo:list-item-body>							</fo:list-item>						</xsl:for-each>					</fo:list-block>				</fo:flow>			</fo:page-sequence>			<!-- #################### Page sequences ####################### -->			<fo:page-sequence master-reference="Chapter" force-page-count="even" initial-page-number="auto">				<!-- Page numbers / margins -->				<fo:static-content flow-name="first-region-after">					<fo:block text-align="right">Page <fo:page-number/>					</fo:block>				</fo:static-content>				<fo:static-content flow-name="even-region-after">					<fo:block text-align="left">Page <fo:page-number/>					</fo:block>				</fo:static-content>				<fo:static-content flow-name="odd-region-after">					<fo:block text-align="right">Page <fo:page-number/>					</fo:block>				</fo:static-content>				<!-- Title -->				<fo:static-content flow-name="even-region-before">					<fo:block text-align-last="justify" xsl:use-attribute-sets="marginalia">						<fo:external-graphic src="../Images/Comelio-Logo-Small.png"/>						<fo:leader leader-pattern="space"/> www.comelio-seminare.com</fo:block>				</fo:static-content>				<fo:static-content flow-name="odd-region-before">					<fo:block text-align-last="justify" xsl:use-attribute-sets="marginalia">						<xsl:value-of select="$translation-list//Translation[ID = '1' and Language = $language]/Value"/>						<fo:leader leader-pattern="space"/>						<fo:external-graphic src="../Images/Comelio-Logo-Small.png"/>					</fo:block>				</fo:static-content>				<!-- Regular content -->				<fo:flow flow-name="xsl-region-body">					<xsl:apply-templates select="//COURSE">						<xsl:sort select="TITLE"/>						<xsl:sort select="SUBTITLE"/>					</xsl:apply-templates>				</fo:flow>			</fo:page-sequence>		</fo:root>	</xsl:template>	<!-- #################### Element templates ####################### -->	<!-- COURSE -->	<xsl:template match="COURSE">	<!-- id-attribute created for TOC -->		<fo:block xsl:use-attribute-sets="title2" id="{concat(TITLE, ' - ' , SUBTITLE)}">			<!-- Title(s) -->			<xsl:value-of select="concat(TITLE, ' - ', SUBTITLE)"/>		</fo:block>		<!-- Blind table for two columns -->		<fo:table width="100%" table-layout="fixed" xsl:use-attribute-sets="standard">			<fo:table-column column-number="1" column-width="50%"/>			<fo:table-column column-number="2" column-width="50%"/>			<fo:table-body>				<fo:table-row>					<!-- 1st column -->					<fo:table-cell padding-right="5pt">						<fo:block>							<xsl:call-template name="training-details"/>						</fo:block>						<fo:block xsl:use-attribute-sets="title3">Course objectives</fo:block>						<fo:block text-align="justify">							<xsl:value-of select="OBJECTIVES"/>						</fo:block>					</fo:table-cell>					<!-- 2nd column -->					<fo:table-cell padding-left="5pt">						<fo:block>							<xsl:if test="count(DATE-LIST/DATE) != 0">								<xsl:call-template name="date-details"/>							</xsl:if>						</fo:block>					</fo:table-cell>				</fo:table-row>			</fo:table-body>		</fo:table>		<!-- Modules -->		<xsl:apply-templates select="Module-List"/>	</xsl:template>	<!-- Modules -->	<xsl:template match="Module-List">		<fo:block xsl:use-attribute-sets="title3">Course Contents</fo:block>		<xsl:for-each select="Module">			<fo:block xsl:use-attribute-sets="title4">				<xsl:value-of select="concat(Order, ') ', Title)"/>			</fo:block>			<!-- "Days" or "Day" after Length? -->			<fo:block text-align="justify" xsl:use-attribute-sets="standard">				<xsl:if test="count(Length) != 0">					<xsl:text>[</xsl:text>					<xsl:value-of select="Length"/>					<xsl:choose>						<xsl:when test="Length != 1"> Days</xsl:when>						<xsl:otherwise> Day</xsl:otherwise>					</xsl:choose>					<xsl:text>] </xsl:text>				</xsl:if>				<xsl:value-of select="Synopsis"/>			</fo:block>		</xsl:for-each>		<!-- Page break after course -->		<fo:block page-break-after="always"/>	</xsl:template>	<!-- #################### Named templates ####################### -->	<!-- Training details -->	<xsl:template name="training-details">		<fo:table width="100%" table-layout="fixed">			<fo:table-column column-number="1" column-width="30%"/>			<fo:table-column column-number="2" column-width="60%"/>			<fo:table-body>				<fo:table-row>					<fo:table-cell>						<fo:block>Course ID</fo:block>					</fo:table-cell>					<fo:table-cell>						<fo:block>							<xsl:value-of select="@id"/>						</fo:block>					</fo:table-cell>				</fo:table-row>				<fo:table-row>					<fo:table-cell>						<fo:block>Level</fo:block>					</fo:table-cell>					<fo:table-cell>						<fo:block>							<xsl:value-of select="COURSE_LEVEL"/>						</fo:block>					</fo:table-cell>				</fo:table-row>				<fo:table-row>					<fo:table-cell>						<fo:block>Target group</fo:block>					</fo:table-cell>					<fo:table-cell>						<fo:block>							<xsl:value-of select="TARGET_GROUP"/>						</fo:block>					</fo:table-cell>				</fo:table-row>				<xsl:if test="count(MANUFACTURER) != 0">					<fo:table-row>						<fo:table-cell>							<fo:block>Manufacturer</fo:block>						</fo:table-cell>						<fo:table-cell>							<fo:block>								<xsl:value-of select="MANUFACTURER"/>							</fo:block>						</fo:table-cell>					</fo:table-row>				</xsl:if>				<fo:table-row>					<fo:table-cell>						<fo:block>Method</fo:block>					</fo:table-cell>					<fo:table-cell>						<fo:block>							<xsl:value-of select="COURSE_METHOD"/>						</fo:block>					</fo:table-cell>				</fo:table-row>			</fo:table-body>		</fo:table>	</xsl:template>	<!-- Date details -->	<xsl:template name="date-details">		<fo:block>Dates</fo:block>		<fo:table width="100%" table-layout="fixed">			<fo:table-column column-number="1" column-width="25%"/>			<fo:table-column column-number="2" column-width="25%"/>			<fo:table-column column-number="3" column-width="25%"/>			<fo:table-column column-number="4" column-width="25%"/>			<fo:table-header>				<fo:table-row>					<fo:table-cell>						<fo:block>City</fo:block>					</fo:table-cell>					<fo:table-cell>						<fo:block>Start</fo:block>					</fo:table-cell>					<fo:table-cell>						<fo:block>End</fo:block>					</fo:table-cell>					<fo:table-cell>						<fo:block>Net Price</fo:block>					</fo:table-cell>				</fo:table-row>			</fo:table-header>			<fo:table-body>				<xsl:for-each select="DATE-LIST/DATE">					<fo:table-row>						<fo:table-cell>							<fo:block>								<xsl:value-of select="CITY"/>							</fo:block>						</fo:table-cell>						<fo:table-cell>							<fo:block>								<xsl:value-of select="START_DATE"/>							</fo:block>						</fo:table-cell>						<fo:table-cell>							<fo:block>								<xsl:value-of select="END_DATE"/>							</fo:block>						</fo:table-cell>						<fo:table-cell>							<fo:block>								<xsl:value-of select="concat(PRICE, ' ', @currencyCode)"/>							</fo:block>						</fo:table-cell>					</fo:table-row>				</xsl:for-each>			</fo:table-body>		</fo:table>	</xsl:template></xsl:stylesheet>